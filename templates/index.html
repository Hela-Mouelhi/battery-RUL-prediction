<!-- templates/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Battery Health & RUL Estimation</title>
    <link rel="stylesheet" href="static\style.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîã Battery Lifetime & Health Estimation</h1>
        </div>

        {% if error_message %}
            <div class="error-message">
                <strong>‚ö†Ô∏è Error:</strong> {{ error_message }}
            </div>
        {% endif %}

        <form method="POST">
            <div class="form-section">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="temperature">Battery Temperature (¬∞C)</label>
                        <input type="number" step="any" name="temperature" id="temperature" required 
                               value="{{ request.form.temperature or 33.5 }}">
                        <span class="help-text">Typical range: 32 ‚Äì 36 ¬∞C</span>
                    </div>

                    <div class="form-group">
                        <label for="mean_dQdV">Mean dQ/dV</label>
                        <input type="number" step="any" name="mean_dQdV" id="mean_dQdV" required 
                               value="{{ request.form.mean_dQdV or -0.735 }}">
                        <span class="help-text">Typical range: -0.765 to -0.722</span>
                    </div>

                    <div class="form-group">
                        <label for="max_dQdV">Max dQ/dV</label>
                        <input type="number" step="any" name="max_dQdV" id="max_dQdV" required 
                               value="{{ request.form.max_dQdV or 0 }}">
                        <span class="help-text">Usually 0 or small negative value</span>
                    </div>

                    <div class="form-group">
                        <label for="voltage">Battery Voltage (V)</label>
                        <input type="number" step="any" name="voltage" id="voltage" required 
                               value="{{ request.form.voltage or 3.12 }}">
                        <span class="help-text">Typical range: 3.10 ‚Äì 3.13 V</span>
                    </div>

                    <div class="form-group">
                        <label for="current">Battery Current (A)</label>
                        <input type="number" step="any" name="current" id="current" required 
                               value="{{ request.form.current or -0.03 }}">
                        <span class="help-text">Discharge current (negative) or charge current (positive)</span>
                    </div>

                    <div class="form-group">
                        <label for="Qd">Qd</label>
                        <input type="number" step="any" name="Qd" id="Qd" required 
                               value="{{ request.form.Qd or 0.3 }}">
                        <span class="help-text">Typical value: 0.29 ‚Äì 0.31</span>
                    </div>

                    <!-- Compact Current Cycle Count Section -->
                    <div class="cycle-count-compact">
                        <label for="current_cycles">Current Cycle Count</label>
                        <input type="number" step="any" name="current_cycles" id="current_cycles" required 
                               value="{{ request.form.current_cycles or 0 }}">
                        <span class="help-text">Enter number of cycles already completed</span>
                    </div>
                </div>
            </div>

            <button type="submit" class="submit-btn">Estimate Battery Health</button>
        </form>

        {% if predicted_life %}
        <div class="results-card">
            <h3 class="results-header">üìä Estimation Results</h3>
            
            <div class="result-grid">
                <div class="result-item">
                    <div class="result-label">Predicted Total Lifetime</div>
                    <div class="result-value">{{ predicted_life | round(0) }} <span class="unit">cycles</span></div>
                </div>
                
                <div class="result-item">
                    <div class="result-label">Remaining Useful Life (RUL)</div>
                    <div class="result-value">{{ rul | round(0) }} <span class="unit">cycles</span></div>
                </div>
                
                <div class="result-item">
                    <div class="result-label">Failure Probability</div>
                    <div class="result-value">{{ failure_prob | round(1) }} <span class="unit">%</span></div>
                </div>
            </div>
            
            <div class="form-group" style="margin-top: 30px;">
                <div class="result-label">Battery Health Status</div>
                <div>
                    {% if failure_prob < 30 %}
                        <span class="health-status healthy">Healthy</span>
                    {% elif failure_prob < 70 %}
                        <span class="health-status warning">Warning</span>
                    {% else %}
                        <span class="health-status critical">Critical</span>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endif %}
    </div>
</body>
</html>